<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-enhancements docs-version-current docs-doc-page docs-doc-id-pouf/pouf1" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Uptane Reference Implementation POUF | Uptane</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://uptane.org/enhancements/pouf/pouf1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="uptane, secure software update framework for automobiles"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-enhancements-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-enhancements-current"><meta data-rh="true" property="og:title" content="Uptane Reference Implementation POUF | Uptane"><meta data-rh="true" name="description" content="- POUF: 1"><meta data-rh="true" property="og:description" content="- POUF: 1"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://uptane.org/enhancements/pouf/pouf1"><link data-rh="true" rel="alternate" href="https://uptane.org/enhancements/pouf/pouf1" hreflang="en"><link data-rh="true" rel="alternate" href="https://uptane.org/enhancements/pouf/pouf1" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WZ6MBDOHOT-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Uptane RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Uptane Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G856J3S8ZG"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-G856J3S8ZG",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Uptane" href="/opensearch.xml">


<link rel="stylesheet" href="/fonts/font-awesome/fontawesome.css">
<link rel="stylesheet" href="/fonts/font-awesome/solid.css">
<link rel="stylesheet" href="/fonts/font-awesome/regular.css">
<link rel="stylesheet" href="/fonts/font-awesome/brands.css"><link rel="stylesheet" href="/assets/css/styles.8ecdc2df.css">
<script src="/assets/js/runtime~main.92ac522c.js" defer="defer"></script>
<script src="/assets/js/main.f3340a23.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/uptane_logo_light.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/uptane_logo_dark.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/learn-more/about">About Us</a><a class="navbar__item navbar__link" href="/docs/2.1.0/standard/uptane-standard">Standard</a><a class="navbar__item navbar__link" href="/docs/2.1.0/deployment/best-practices">Best Practices</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Enhancements</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/enhancements/pouf/pouf-main">POUF</a></li><li><a class="dropdown__link" href="/enhancements/pures/pure1">PUREs</a></li></ul></div><a class="navbar__item navbar__link" href="/learn-more/getting-started">Learn More</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/uptane/uptane.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fab fa-lg fa-github"> </a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/2.1.0/standard/uptane-standard">2.1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/latest/standard/uptane-standard">Latest (2.1.0)</a></li><li><a class="dropdown__link" href="/docs/2.1.0/standard/uptane-standard">2.1.0</a></li><li><a class="dropdown__link" href="/docs/2.0.0/standard/uptane-standard">2.0.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/standard/uptane-standard">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.0/standard/uptane-standard">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.0/standard/uptane-standard">1.0.0</a></li><li><a class="dropdown__link" href="/docs/latest/all-versions">All versions</a></li></ul></div><div class="toggle_MW0i colorModeToggle_DEke"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_SFTY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ekgs"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/enhancements/pouf/pouf-main">pouf</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/enhancements/pouf/pouf-main">POUF Purpose and Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/enhancements/pouf/pouf1">Uptane Reference Implementation POUF</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/enhancements/pures/pure1">pures</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">pouf</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Uptane Reference Implementation POUF</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Uptane Reference Implementation POUF</h1></header><ul>
<li>POUF: 1</li>
<li>Title: Uptane Reference Implementation POUF</li>
<li>Version: 1</li>
<li>Last-Modified: 17-07-2019</li>
<li>Author: Marina Moore</li>
<li>Status: Draft</li>
<li>Uptane Version Implemented: 1.0.0</li>
<li>Created: 14-03-2019</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract">Abstract<a href="#abstract" class="hash-link" aria-label="Direct link to Abstract" title="Direct link to Abstract">​</a></h2>
<p>This document describes the Protocols, Operations, Usage, and Formats (POUF) for the Uptane reference implementation written in Python by NYU. POUFs are designed to allow interoperable Uptane implementations. Any implementer who wishes to interoperate with the reference implementation should implement the features and data structures described in this document.</p>
<p><strong>Note that this implementation is not meant to be used in practice</strong>. It is a guide for implementers to understand how the system should function.</p>
<p>The reference implementation includes all required and most optional features as a reference for others looking to implement Uptane.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="protocols">Protocols<a href="#protocols" class="hash-link" aria-label="Direct link to Protocols" title="Direct link to Protocols">​</a></h2>
<p>This POUF uses ASN.1/DER encoding for transmitting files. The details of the file formats are described in <a href="#formats">Formats</a> in ASN.1 notation. Note that improper decoding of ASN.1 may lead to arbitrary code execution or Denial-of-Service attacks. Any implementers of this POUF should be aware of these attacks and use a decoder which has been subject to appropriate security analysis.</p>
<p>The Primary ECU communicates with the Director repository, Image repository, and time server using HTTP POST requests over <a href="http://xmlrpc.scripting.com/spec.html" target="_blank" rel="noopener noreferrer">XML-RPC</a>. In this communication, the Primary ECU acts as an XML-RPC client and the Director repository, Image repository, and time server act as XML-RPC servers. Secondary ECUs communicate with a Primary ECU using HTTP POST requests over XML-RPC. The Primary acts as the XML-RPC server and the Secondary as an XML-RPC client. The requests supported by all XML-RPC servers in this POUF are described in the Message Handler Table.</p>
<p>All XML-RPC traffic supported in this POUF is transmitted over TCP/IP and does not support CAN or other network types. For more information about internal vehicle communication, see the <a href="https://uptane.github.io/deployment-considerations/index.html" target="_blank" rel="noopener noreferrer">Deployment Best Practices</a> document.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="message-handler-table">Message Handler Table<a href="#message-handler-table" class="hash-link" aria-label="Direct link to Message Handler Table" title="Direct link to Message Handler Table">​</a></h2>
<p>The following message handlers must be implemented. These message handlers are used during the update process described in the Uptane Standard. The format of messages in the Data and Response columns are described in <a href="#formats">Formats</a>. The messages are sent using XML-RPC with the function names in the Request column and data from the Data column.</p>
<table><thead><tr><th>Request</th><th>Sender</th><th>Receiver</th><th>Data</th><th>Response</th><th>Specification Reference</th></tr></thead><tbody><tr><td>submit_vehicle_manifest</td><td>Primary ECU</td><td>Director Repository</td><td>VehicleVersionManifest</td><td></td><td><a href="https://uptane.github.io/docs/standard/uptane-standard#532-director-repository" target="_blank" rel="noopener noreferrer">https://uptane.github.io/docs/standard/uptane-standard#532-director-repository</a></td></tr><tr><td>register_ecu_serial</td><td>Primary ECU</td><td>Director Repository</td><td>ecu_serial Identifier, ecu_public_key PublicKey, vin Identifier, is_primary BOOLEAN</td><td></td><td></td></tr><tr><td>get_signed_time</td><td>Primary ECU</td><td>Timeserver</td><td>SequenceOfTokens</td><td>CurrentTime</td><td></td></tr><tr><td>submit_ecu_manifest</td><td>Secondary ECU</td><td>Primary ECU</td><td>vin Identifier, ecu_serial Identifier, nonce, ECUVersionManifestSigned</td><td></td><td><a href="https://uptane.github.io/docs/standard/uptane-standard#5436-create-and-send-version-report" target="_blank" rel="noopener noreferrer">https://uptane.github.io/docs/standard/uptane-standard#5436-create-and-send-version-report</a></td></tr><tr><td>register_new_secondary</td><td>Secondary ECU</td><td>Primary ECU</td><td>ecu_serial Identifier</td><td></td><td></td></tr><tr><td>get_time_attestation_for_ecu</td><td>Secondary ECU</td><td>Primary ECU</td><td>ecu_serial Identifier</td><td></td><td><a href="https://uptane.github.io/docs/standard/uptane-standard#5425-send-latest-time-to-secondaries" target="_blank" rel="noopener noreferrer">https://uptane.github.io/docs/standard/uptane-standard#5425-send-latest-time-to-secondaries</a></td></tr><tr><td>get_image</td><td>Secondary ECU</td><td>Primary ECU</td><td>ecu_serial Identifier</td><td></td><td><a href="https://uptane.github.io/docs/standard/uptane-standard#5427-send-images-to-secondaries" target="_blank" rel="noopener noreferrer">https://uptane.github.io/docs/standard/uptane-standard#5427-send-images-to-secondaries</a></td></tr><tr><td>get_metadata</td><td>Secondary ECU</td><td>Primary ECU</td><td>ecu_serial Identifier, is_partial_verification BOOLEAN</td><td></td><td><a href="https://uptane.github.io/docs/standard/uptane-standard#5426-send-metadata-to-secondaries" target="_blank" rel="noopener noreferrer">https://uptane.github.io/docs/standard/uptane-standard#5426-send-metadata-to-secondaries</a></td></tr></tbody></table>
<p>In addition to the above message handlers, the Director repository hosts the RootMetadata, TargetsMetadata, SnapshotMetadata, and TimestampMetadata using XML-RPC. The filenames for these files will be</p>
<role>.der where role is the associated role (Root, Targets, Snapshot, or Timestamp) in lowercase. The url of the hosted directory will be loaded onto ECUs at the time of manufacture.</role>
<p>The Image repository hosts the RootMetadata, TargetsMetadata, SnapshotMetadata, TimestampMetadata, and images. The filenames for the metadata files are</p>
<role>.der where role is the associated role (Root, Targets, Snapshot, or Timestamp) in lowercase. The filenames for the images are specified in the custom field of Targets metadata on the Image repository as described in the <a href="https://uptane.github.io/docs/standard/uptane-standard#5231-metadata-about-images">Uptane Standard</a>. The url of the hosted directory will be loaded onto Primary ECUs and full verification Secondary ECUs at the time of manufacture.</role>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="operations">Operations<a href="#operations" class="hash-link" aria-label="Direct link to Operations" title="Direct link to Operations">​</a></h2>
<p>Of course, as the system implements Uptane, the reference implementation follows the requirements of the Uptane Standard. In addition to the required features, the reference implementation follows most of the SHOULDs of the standard in order to demonstrate how Uptane is expected to operate. The implementation details and rationale behind any SHOULDs and MAYs that are implemented are described in this section.</p>
<p>The Primary ECU in this POUF is also the ECU that communicates with the Director repository, Image repository, and time server. This simplifies the reference implementation by condensing all the requirements for external communication and initial validation into a single ECU.</p>
<p>To access a reliable current time as needed for the <a href="https://uptane.github.io/docs/standard/uptane-standard#54-in-vehicle-implementation-requirements" target="_blank" rel="noopener noreferrer">In Vehicle Implementation Requirements</a>, ECUs in this POUF use a time server that produces a time attestation for each update cycle. The Primary ECU sends the time server nonce tokens from each ECU, then the time server returns a time attestation that contains a signed the current time with all the tokens, as described in the <a href="https://uptane.github.io/deployment-considerations/index.html" target="_blank" rel="noopener noreferrer">Deployment Best Practices</a> document. The ASN.1 details of the time server are listed in <a href="#formats">Formats</a>. The time server is used by the reference implementation as a self contained way to ensure secure access to the current time.</p>
<p>Additionally, this POUF supports custom delegated Targets roles and terminating delegations, features described as optional in the <a href="https://uptane.github.io/docs/standard/uptane-standard#5121-delegations" target="_blank" rel="noopener noreferrer">Standard</a>. As explained in the Standard, terminating delegations are not used by default. To use custom roles, the Targets role on the Image repository sets up a delegation. Delegations used in this POUF must support multi-role delegations, as explained in <a href="https://github.com/theupdateframework/taps/blob/d0818e580c322815a473520f2e8cc5f5eb8df499/tap3.md" target="_blank" rel="noopener noreferrer">TAP 3</a>. In addition, delegation filenames are listed using an enumerated list that supports shell-style <a href="https://uptane.github.io/docs/standard/uptane-standard#5232-metadata-about-delegations" target="_blank" rel="noopener noreferrer">wildcards</a>. In the name of a directory or file the wildcard character &#x27;%&#x27; may be used to represent multiple characters and &#x27;?&#x27; may be used to represent a single character. For example, &quot;foo/%.txt&quot; could represent &quot;foo/bar.txt&quot; but not &quot;foo/bar.md&quot;. In addition &quot;foo/file-?.txt&quot; could represent &#x27;foo/file-a.txt&quot; but not &quot;foo/file-bar.txt&quot;. Wildcards will not be used only for standard alpha-numeric characters. Delegations are supported in the reference implementation to demonstrate how they can be used to establish a chain of trust for specific images.</p>
<p>Public key identifiers use the hash of the key value, encryption algorithm, and verification scheme for a condensed identifier. The format of these identifiers is further described in <a href="#formats">Formats</a>. This POUF supports RSA and ED25519 hashes for public keys. The hashing algorithm must be specified in the signature method.</p>
<p>This POUF supports asymmetric keys and uses the <a href="https://uptane.github.io/uptane-standard/uptane-standard.html#build-time-prerequisite-requirements-for-ecus" target="_blank" rel="noopener noreferrer">same keys for encrypting and signing</a>. Using the same keys allows for a simplified reference implementation and less key management. In particular, each ECU has a private key and registers the associated public key with the Director repository. The ECU will use the private key to sign the vehicle version manifest and the Director repository may use the public key to encrypt images per ECU. In addition, each metadata role has either online or offline private keys that are used on the Director and Image repositories. The public keys associated with these roles are used by the ECUs during validation.</p>
<p>The Image repository and Director repository have public interfaces for communication with ECUs. To make the public interface, the Image and Directory repositories each store metadata in a filesystem that is hosted to form the public interface. These interfaces do not require authentication to read.</p>
<p>The Director repository identifies a vehicle using the vehicle version manifest sent by the Primary ECU to initiate an update. The Director checks the vehicle version manifest as described in the standard, but does not make any additional checks. If ECUs are added to the vehicle, they must be registered with the Director using the register_ecu_serial function described in the <a href="#message-handler-table">Message Handler Table</a>. If other changes are made to ECUs in a vehicle without notifying the Director, we reserve the right to change how the Director reacts to these ECUs. Using the information in the vehicle version manifest, the Director determines what images need to be installed.</p>
<p>This POUF does not support sending vehicle version manifests as <a href="https://uptane.github.io/docs/standard/uptane-standard#5421-construct-and-send-vehicle-version-manifest" target="_blank" rel="noopener noreferrer">diffs</a> to simplify the Director implementation. Sending the full manifest requires some additional bandwidth, but allows the Director to more efficiently parse the manifest.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="metadata">Metadata<a href="#metadata" class="hash-link" aria-label="Direct link to Metadata" title="Direct link to Metadata">​</a></h2>
<p>This POUF supports some metadata features that are optional in the Uptane Standard, but are required for an implementation of this POUF. These features are included in the metadata definitions in <a href="#formats">Formats</a>. The details of these features are:</p>
<ul>
<li>The metadata version will increment on an update to the metadata.</li>
<li>Root metadata must support <a href="https://uptane.github.io/docs/standard/uptane-standard#522-root-metadata" target="_blank" rel="noopener noreferrer">mappings of roles to lists of URLs as described in TAP 5</a>.</li>
<li>Repository mapping metadata will be included using a map file. The format of this file is described in <a href="#formats">Formats</a>. In the mapping metadata, files are expressed using an enumerated list that supports wildcards.</li>
<li>If images are encrypted per ECU, metadata about encrypted images may be included in the custom field of Targets metadata as described in the <a href="https://uptane.github.io/docs/standard/uptane-standard#52311-custom-metadata-about-images" target="_blank" rel="noopener noreferrer">Standard</a>. The Image repository does not know which ECU will receive the image, so cannot provide an image encrypted per ECU. Therefore, both the Image and Director repositories will contain metadata about the unencrypted image in Targets metadata and metadata about encrypted images will be but in the custom field of Targets metadata from the Director.</li>
<li>The custom field of Targets metadata on the Director repository must support an <a href="https://uptane.github.io/docs/standard/uptane-standard#52311-custom-metadata-about-images" target="_blank" rel="noopener noreferrer">encrypted target field for encrypting images per ECU</a>. In addition, the custom field will contain a release counter and hardware id from both the Director and Image repositories. This POUF does not support the Director adding a download URL to the custom field of Targets metadata.</li>
<li>The custom field of Targets metadata on the Director and Image repositories are not compared. This means that the must match functionality described in the <a href="https://uptane.github.io/docs/standard/uptane-standard#52311-custom-metadata-about-images" target="_blank" rel="noopener noreferrer">Standard</a> is not supported. This is not included for backwards compatibility reasons. A client may choose to compare some fields of Targets metadata, but these checks are not required by this POUF. If all other fields match, the custom metadata from the Director is used.</li>
<li>Snapshot metadata in this POUF does not include the Root filename or version. These fields are included in implementations that do not use <a href="https://github.com/theupdateframework/taps/blob/01726d203c9b9c029d26f6612069ce3180500d9a/tap5.md#downloading-metadata-and-target-files" target="_blank" rel="noopener noreferrer">TAP 5</a>. Because this POUF implements TAP 5, the Root filename and version do not need to be included in Snapshot metadata.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>Key management and image generation are not handled by this POUF. The POUF uses online keys for all roles to demonstrate Uptane functionality. This practice is not recommended for Uptane implementers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-setup">Server Setup<a href="#server-setup" class="hash-link" aria-label="Direct link to Server Setup" title="Direct link to Server Setup">​</a></h2>
<p>The Uptane Reference Implementation does the following setup before any updates can be installed:</p>
<ul>
<li>The Director repository is initialized with the private keys for all roles with online keys. These keys are stored on the Director so they can be used to automatically sign valid metadata. Any offline keys, for example the Root key, should not be stored on the repository.</li>
<li>An inventory database is initialized on the Director repository. This database contains fields for vehicle manifests, ECU manifests, a mapping that associates vehicles to ECUs, and the ECU public keys. This database is used and updated during the update process.</li>
<li>ECUs register with the Director repository. Each ECU on a vehicle must register by sending its ECU id and ECU public key to the Director repository. This information from registration is stored in the inventory database.</li>
<li>The timeserver is initialized with a timeserver private key.</li>
<li>Each ECU needs to be preloaded with the urls and directory locations of the Director repository and Image repository. In addition, each ECU needs to be loaded with the Image and Director public keys at the time of manufacture. For details about what keys are needed on each ECU, see the <a href="#data-table">Data Table</a>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-table">Data Table<a href="#data-table" class="hash-link" aria-label="Direct link to Data Table" title="Direct link to Data Table">​</a></h2>
<p>Each device involved in the update process is expected to have access to certain data. The required devices are expected to have at least the following data:</p>
<table><thead><tr><th>Location</th><th>Data</th></tr></thead><tbody><tr><td>Primary ECU</td><td>ECU private key <em>Timeserver public key</em> Currently installed version <em>Secondary&#x27;s Vehicle Version Manifests</em> The most recent Root, Timestamp, Targets, and Snapshot metadata (for a new installation, just the known Root metadata) from both the Image and Director repositories <em>Image repository public key for each metadata role and the associated threshold. These values are available in the current metadata files.</em> Director repository public key for each metadata role and the associated thresholds. These values are available in the current metadata files.</td></tr><tr><td>Full verification Secondary ECU</td><td>ECU private key <em>Timeserver public key</em> Currently installed version * The most recent Root, Timestamp, Targets, and Snapshot metadata (for a new installation, just the known Root metadata) from both the Image and Director repositories</td></tr><tr><td>Partial verification Secondary ECU</td><td>ECU private key <em>Timeserver public key</em> Currently installed version * Director&#x27;s Targets metadata public key</td></tr><tr><td>Director Repository</td><td>ECU public keys <em>Metadata about images</em> Inventory database <em>Online metadata private Director metadata keys</em> Metadata signed by offline Director metadata keys</td></tr><tr><td>Image Repository</td><td>ECU public keys <em>Metadata about images</em> Images <em>Online metadata private image metadata keys</em> Metadata signed by offline image metadata keys</td></tr><tr><td>Timeserver</td><td>Timeserver private key * Current time</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="formats">Formats<a href="#formats" class="hash-link" aria-label="Direct link to Formats" title="Direct link to Formats">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-formats">File formats<a href="#file-formats" class="hash-link" aria-label="Direct link to File formats" title="Direct link to File formats">​</a></h2>
<p>Files will be transmitted as described in the Uptane standard and in the <a href="#message-handler-table">Message Handler Table</a> using the definitions in this section. These definitions describe what data should be transmitted in each of these messages and how the data will be laid out. The fields of each file should be in the exact order specified here to allow clients and servers to interoperate. Files are encoded in ASN.1/DER and sent over XML-RPC as described in <a href="#protocols">Protocols</a>.</p>
<p>At the top of this section are some definitions used throughout the files and for the metadata. After these are descriptions of the metadata and other files.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-definitions">Common Definitions<a href="#common-definitions" class="hash-link" aria-label="Direct link to Common Definitions" title="Direct link to Common Definitions">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RoleType        ::= ENUMERATED {root, targets, snapshot, timestamp}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- String types.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filename        ::= VisibleString (SIZE(1..32))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- No known path separator allowed in a strict filename.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StrictFilename  ::= VisibleString (SIZE(1..32))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  (PATTERN &quot;[^/\\]+&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OctetString     ::= OCTET STRING  (SIZE(1..1024))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paths           ::= SEQUENCE (SIZE(1..8)) OF Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path            ::= VisibleString (SIZE(1..32))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  (PATTERN &quot;[\w\*\\/]+&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URLs            ::= SEQUENCE OF URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL             ::= VisibleString (SIZE(1..1024))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- A generic identifier for vehicles, Primaries, Secondaries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Identifier      ::= VisibleString (SIZE(1..32))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Natural         ::= INTEGER (0..MAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Positive        ::= INTEGER (1..MAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Length          ::= Natural</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Threshold       ::= Positive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Version         ::= Natural</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- The date and time in UTC encoded as a UNIX timestamp.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UTCDateTime     ::= Positive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hashes          ::= SEQUENCE (SIZE(1..8)) OF Hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash            ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function      HashFunction,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  digest        OctetString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HashFunction ::= ENUMERATED {sha224, sha256, sha384, sha512, sha512-224,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             sha512-256, ...}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Keyids          ::= SEQUENCE (SIZE(1..8)) OF Keyid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Usually, a hash of a public key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Keyid           ::= OctetString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Signatures      ::= SEQUENCE (SIZE(1..8)) OF Signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Signature       ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyid         Keyid,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  method        SignatureMethod,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- For efficient checking, sign the hash of the message instead of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- message itself.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hash          Hash,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- The signature itself.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  value         OctetString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SignatureMethod ::= ENUMERATED {rsassa-pss, ed25519, ...}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PublicKeys      ::= SEQUENCE (SIZE(1..8)) OF PublicKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PublicKey       ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  publicKeyid     Keyid,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  publicKeyType   PublicKeyType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  publicKeyValue  OctetString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PublicKeyType   ::= ENUMERATED {rsa, ed25519, ...}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-format">Metadata Format<a href="#metadata-format" class="hash-link" aria-label="Direct link to Metadata Format" title="Direct link to Metadata Format">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Metadata      ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signed              Signed,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfSignatures  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signatures          Signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Signed        ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type        RoleType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    expires     UTCDateTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version     Positive,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    body        SignedBody</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SignedBody    ::= CHOICE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rootMetadata      RootMetadata,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetsMetadata   TargetsMetadata,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    snapshotMetadata  SnapshotMetadata,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timestampMetadata TimestampMetadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="root">Root<a href="#root" class="hash-link" aria-label="Direct link to Root" title="Direct link to Root">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RootMetadata ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfKeys  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys          PublicKeys,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfRoles Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    roles         TopLevelRoles,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TopLevelRoles ::= SEQUENCE (SIZE(4)) OF TopLevelRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TopLevelRole  ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    role            RoleType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- TAP 5: The URLs pointing to the metadata file for this role.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfURLs    Length OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    urls            URLs OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfKeyids  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyids          Keyids,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threshold       Threshold,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -- Adjust length of SEQUENCE OF to your needs.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="snapshot">Snapshot<a href="#snapshot" class="hash-link" aria-label="Direct link to Snapshot" title="Direct link to Snapshot">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SnapshotMetadata ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfSnapshotMetadataFiles Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    snapshotMetadataFiles         SnapshotMetadataFiles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SnapshotMetadataFiles ::= SEQUENCE (SIZE(1..128)) OF SnapshotMetadataFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SnapshotMetadataFile ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filename  StrictFilename,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version   Version,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="targets">Targets<a href="#targets" class="hash-link" aria-label="Direct link to Targets" title="Direct link to Targets">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TargetsMetadata ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Allowed to have no targets at all.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfTargets Natural,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Metadata about unencrypted images on a repository.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targets         Targets,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Delegations are optional.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delegations     TargetsDelegations OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Targets           ::= SEQUENCE (SIZE(1..128)) OF TargetAndCustom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TargetAndCustom   ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The filename, length, and hashes of unencrypted images on a repository.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target  Target,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- This attribute is used to specify additional information, such as which</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- images should be installed by which ECUs, and metadata about encrypted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- images.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    custom  Custom OPTIONAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Target ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filename        Filename,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    length          Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfHashes  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hashes          Hashes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Custom ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- NOTE: The following attributes are specified by both the Image and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Director repositories.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The release counter is used to prevent rollback attacks on images when</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- only the Director repository is compromised.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Every ECU should check that the release counter of its latest image is</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- greater than or equal to the release counter of its previous image.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    releaseCounter        Natural OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The hardware identifier is used to prevent the Director repository,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- when it is compromised, from choosing images for an ECU that were not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- meant for it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Every ECU should check that the hardware ID of its latest image matches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- its hardware ID.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- An OEM MAY define other types of information to further restrict the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- choices that can be made by a compromised Director repository.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hardwareIdentifier    Identifier OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- NOTE: The following attributes are specified only by the Director</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- repository.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The ECU identifier specifies information, e.g., serial numbers, that the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Director uses to point ECUs as to which images they should install.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Every ECU should check that the ECU ID of its latest image matches its</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- own ECU ID.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ecuIdentifier         Identifier OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- This attribute MAY be used by the Director to encrypt images per ECU.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    encryptedTarget       Target OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- This attribute MAY be used if ECU keys are asymmetric, and a per-image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- symmetric encryption key is desired for faster decryption of images.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- In that case, the Director would use the asymmetric ECU key to encrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- this symmetric key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    encryptedSymmetricKey EncryptedSymmetricKey OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EncryptedSymmetricKey ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- This is the symmetric key type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    encryptedSymmetricKeyType   EncryptedSymmetricKeyType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- This is the symmetric key encrypted using the asymmetric ECU key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    encryptedSymmetricKeyValue  OctetString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EncryptedSymmetricKeyType ::= ENUMERATED {aes128, aes192, aes256, ...}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- https://github.com/theupdateframework/taps/blob/master/tap3.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TargetsDelegations  ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The public keys of all delegatees.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfKeys        Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys                PublicKeys,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The role name, filename, public keys, and threshold of a delegatee.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfDelegations Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A list of paths to roles, listed in order of priority.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delegations         PrioritizedPathsToRoles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PrioritizedPathsToRoles ::= SEQUENCE (SIZE(1..8)) OF PathsToRoles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PathsToRoles ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A list of image/target paths entrusted to these roles.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfPaths   Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths           Paths,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A list of roles required to sign the same metadata about the matching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- targets/images.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfRoles   Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    roles           MultiRoles,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Whether or not this delegation is terminating.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    terminating     BOOLEAN DEFAULT FALSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MultiRoles ::= SEQUENCE (SIZE(1..8)) OF MultiRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MultiRole ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The rolename (e.g., &quot;supplierA-dev&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- No known path separator allowed in a rolename.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rolename        StrictFilename,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The public keys used by this role.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfKeyids  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyids          Keyids,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The threshold number of these keys.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threshold       Threshold</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="delegated-targets">Delegated targets<a href="#delegated-targets" class="hash-link" aria-label="Direct link to Delegated targets" title="Direct link to Delegated targets">​</a></h3>
<p>Delegated targets use the same ASN.1 definitions as targets.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="timestamp">Timestamp<a href="#timestamp" class="hash-link" aria-label="Direct link to Timestamp" title="Direct link to Timestamp">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TimestampMetadata ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filename        Filename,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version         Version,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    length          Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfHashes  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hashes          Hashes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="map-file">Map File<a href="#map-file" class="hash-link" aria-label="Direct link to Map File" title="Direct link to Map File">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- https://github.com/theupdateframework/taps/blob/master/tap4.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MapFile ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A list of repositories.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfRepositories  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repositories          Repositories,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --A list of mapping of images to repositories.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfMappings      Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mappings              Mappings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Repositories    ::= SEQUENCE (SIZE(2)) OF Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Repository      ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A shorthand name for the repository, which also specifies the name of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- directory on the client which contains previous and latest metadata.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name              RepositoryName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A list of servers where metadata and targets may be downloaded from.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfServers   Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    servers           URLs,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RepositoryNames ::= SEQUENCE (SIZE(2)) OF RepositoryName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RepositoryName  ::= StrictFilename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Mappings ::= SEQUENCE (SIZE(1)) OF Mapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Mapping  ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The list of targets delegated to the following repositories.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfPaths         Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths                 Paths,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The repositories which MUST all sign the preceding targets.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfRepositories  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repositories          RepositoryNames,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Whether or not this delegation is terminating.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    terminating           BOOLEAN DEFAULT FALSE,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ecu-metadata-and-vehicle-version-manifest">ECU Metadata and Vehicle Version Manifest<a href="#ecu-metadata-and-vehicle-version-manifest" class="hash-link" aria-label="Direct link to ECU Metadata and Vehicle Version Manifest" title="Direct link to ECU Metadata and Vehicle Version Manifest">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- What a Primary sends the Director repository.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VehicleVersionManifest ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The signed portion of the manifest.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signed    VehicleVersionManifestSigned,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The signature on the hash of the signed portion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfSignatures  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signatures          Signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VehicleVersionManifestSigned ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A unique identifier for the vehicle.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vehicleIdentifier           Identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A unique identifier for the Primary sending this manifest.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    primaryIdentifier           Identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfECUVersionManifests Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- An ECU version manifest per Secondary.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ecuVersionManifests         ECUVersionManifests,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A message about a detected security attack, if any.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityAttack  VisibleString (SIZE(1..1024)) OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ECUVersionManifests ::= SEQUENCE (SIZE(1..256)) OF ECUVersionManifest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- What a Secondary sends its Primary after installation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VersionReport ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Token for the time server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tokenForTimeServer Token,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The ECU version manifest for the Director.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ecuVersionManifest ECUVersionManifest,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ECUVersionManifest ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The signed portion of the manifest.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signed      ECUVersionManifestSigned,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The signature on the hash of the signed portion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfSignatures  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signatures          Signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ECUVersionManifestSigned ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A unique identifier for the ECU.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ecuIdentifier   Identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The previous time seen on the time server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    previousTime    UTCDateTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- The latest known time seen on the time server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    currentTime     UTCDateTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- A message about a detected security attack, if any.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityAttack  VisibleString (SIZE(1..1024)) OPTIONAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Metadata about the installed image.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    installedImage  Target,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="time-server">Time Server<a href="#time-server" class="hash-link" aria-label="Direct link to Time Server" title="Direct link to Time Server">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- What a Primary sends the time server: a token from each of its Secondaries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SequenceOfTokens ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfTokens  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tokens          Tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- Adjust length of SEQUENCE OF to your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Tokens  ::= SEQUENCE (SIZE(1..1024)) OF Token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Token   ::= INTEGER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -- What the time server sends in response.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CurrentTime   ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signed              TokensAndTimestamp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfSignatures  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signatures          Signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TokensAndTimestamp ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numberOfTokens  Length,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tokens          Tokens,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timestamp       UTCDateTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/enhancements/pouf/pouf-main"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">POUF Purpose and Guidelines</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/enhancements/pures/pure1"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">PURE Purpose and Guidelines</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#protocols" class="table-of-contents__link toc-highlight">Protocols</a></li><li><a href="#message-handler-table" class="table-of-contents__link toc-highlight">Message Handler Table</a></li><li><a href="#operations" class="table-of-contents__link toc-highlight">Operations</a></li><li><a href="#metadata" class="table-of-contents__link toc-highlight">Metadata</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#server-setup" class="table-of-contents__link toc-highlight">Server Setup</a></li><li><a href="#data-table" class="table-of-contents__link toc-highlight">Data Table</a></li><li><a href="#formats" class="table-of-contents__link toc-highlight">Formats</a></li><li><a href="#file-formats" class="table-of-contents__link toc-highlight">File formats</a><ul><li><a href="#common-definitions" class="table-of-contents__link toc-highlight">Common Definitions</a></li><li><a href="#metadata-format" class="table-of-contents__link toc-highlight">Metadata Format</a></li><li><a href="#root" class="table-of-contents__link toc-highlight">Root</a></li><li><a href="#snapshot" class="table-of-contents__link toc-highlight">Snapshot</a></li><li><a href="#targets" class="table-of-contents__link toc-highlight">Targets</a></li><li><a href="#delegated-targets" class="table-of-contents__link toc-highlight">Delegated targets</a></li><li><a href="#timestamp" class="table-of-contents__link toc-highlight">Timestamp</a></li><li><a href="#map-file" class="table-of-contents__link toc-highlight">Map File</a></li><li><a href="#ecu-metadata-and-vehicle-version-manifest" class="table-of-contents__link toc-highlight">ECU Metadata and Vehicle Version Manifest</a></li><li><a href="#time-server" class="table-of-contents__link toc-highlight">Time Server</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer Container_nGT3"><div class="InnerContainer_Kdbd"><div class="ContentContainer_uzrc"><div class="FooterLeft_Fb_0"><div><img src="/img/uptane_logo_light.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" width="200" title="Securing Software Updates for Automobiles"><img src="/img/uptane_logo_dark.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="200" title="Securing Software Updates for Automobiles"></div><div class="Tagline_JAGW">Securing Software Updates for Automobiles</div></div><div class="FooterRight_mGnE"><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">Docs</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/getting-started" label="Getting Started" to="/learn-more/getting-started">Getting Started</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/participate" label="Contributor&#x27;s Guide" to="/learn-more/participate">Contributor&#x27;s Guide</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/about" label="About Us" to="/learn-more/about">About Us</a></ul></div><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">Community</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://discord.com/invite/uWyT6gDCqx" rel="noopener noreferrer" target="_blank" label="Discord">Discord</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://linkedin.com/company/uptane" rel="noopener noreferrer" target="_blank" label="LinkedIn">LinkedIn</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://www.youtube.com/@Uptane" rel="noopener noreferrer" target="_blank" label="Youtube">Youtube</a></ul></div><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">More</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://github.com/uptane" rel="noopener noreferrer" target="_blank" label="GitHub">GitHub</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/blog" label="Blog" to="/blog">Blog</a></ul></div></div></div><div class="BottomContainer_FVSV"><div class="CopyrightText_I8hq">© 2025 Uptane | All Rights Reserved</div></div></div></footer></div>
</body>
</html>