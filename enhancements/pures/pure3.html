<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-enhancements docs-version-current docs-doc-page docs-doc-id-pures/pure3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Scudo: Addressing Software Supply Chain Security in Uptane | Uptane</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://uptane.org/enhancements/pures/pure3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="uptane, secure software update framework for automobiles"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-enhancements-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-enhancements-current"><meta data-rh="true" property="og:title" content="Scudo: Addressing Software Supply Chain Security in Uptane | Uptane"><meta data-rh="true" name="description" content="- Title Addressing Software Supply Chain Security in Uptane"><meta data-rh="true" property="og:description" content="- Title Addressing Software Supply Chain Security in Uptane"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://uptane.org/enhancements/pures/pure3"><link data-rh="true" rel="alternate" href="https://uptane.org/enhancements/pures/pure3" hreflang="en"><link data-rh="true" rel="alternate" href="https://uptane.org/enhancements/pures/pure3" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WZ6MBDOHOT-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Uptane RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Uptane Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G856J3S8ZG"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-G856J3S8ZG",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Uptane" href="/opensearch.xml">


<link rel="stylesheet" href="/fonts/font-awesome/fontawesome.css">
<link rel="stylesheet" href="/fonts/font-awesome/solid.css">
<link rel="stylesheet" href="/fonts/font-awesome/regular.css">
<link rel="stylesheet" href="/fonts/font-awesome/brands.css"><link rel="stylesheet" href="/assets/css/styles.8ecdc2df.css">
<script src="/assets/js/runtime~main.92ac522c.js" defer="defer"></script>
<script src="/assets/js/main.f3340a23.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/uptane_logo_light.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/uptane_logo_dark.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/learn-more/about">About Us</a><a class="navbar__item navbar__link" href="/docs/2.1.0/standard/uptane-standard">Standard</a><a class="navbar__item navbar__link" href="/docs/2.1.0/deployment/best-practices">Best Practices</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Enhancements</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/enhancements/pouf/pouf-main">POUF</a></li><li><a class="dropdown__link" href="/enhancements/pures/pure1">PUREs</a></li></ul></div><a class="navbar__item navbar__link" href="/learn-more/getting-started">Learn More</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/uptane/uptane.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fab fa-lg fa-github"> </a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/2.1.0/standard/uptane-standard">2.1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/latest/standard/uptane-standard">Latest (2.1.0)</a></li><li><a class="dropdown__link" href="/docs/2.1.0/standard/uptane-standard">2.1.0</a></li><li><a class="dropdown__link" href="/docs/2.0.0/standard/uptane-standard">2.0.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/standard/uptane-standard">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.0/standard/uptane-standard">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.0/standard/uptane-standard">1.0.0</a></li><li><a class="dropdown__link" href="/docs/latest/all-versions">All versions</a></li></ul></div><div class="toggle_MW0i colorModeToggle_DEke"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_SFTY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ekgs"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/enhancements/pouf/pouf-main">pouf</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/enhancements/pures/pure1">pures</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/enhancements/pures/pure1">PURE Purpose and Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/enhancements/pures/pure2">Offline Updates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/enhancements/pures/pure3">Scudo: Addressing Software Supply Chain Security in Uptane</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">pures</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Scudo: Addressing Software Supply Chain Security in Uptane</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Scudo: Addressing Software Supply Chain Security in Uptane</h1></header><ul>
<li>Title: Scudo: Addressing Software Supply Chain Security in Uptane</li>
<li>Version: 1</li>
<li>Last-Modified: 2023-02-28</li>
<li>Authors: Marina Moore <a href="mailto:marinamoore@nyu.edu" target="_blank" rel="noopener noreferrer">marinamoore@nyu.edu</a>, Aditya Sirish <a href="mailto:aditya.sirish@nyu.edu" target="_blank" rel="noopener noreferrer">aditya.sirish@nyu.edu</a>, Lois Anne Delong <a href="mailto:lad278@nyu.edu" target="_blank" rel="noopener noreferrer">lad278@nyu.edu</a></li>
<li>Status: Accepted</li>
<li>Content-Type: text/markdown</li>
<li>Created: 2022-03-30</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract">Abstract<a href="#abstract" class="hash-link" aria-label="Direct link to Abstract" title="Direct link to Abstract">​</a></h2>
<p>Software supply chain attacks are on the rise. A 2022 Sonatype report found a
742% increase in the last three years. As a result, companies across all
industry sectors have turned their attention to software supply chain security.
The need to find solutions quickly is further fueled by rapidly increasing
regulations and standards, including President Biden’s U.S.Executive Order 14028.</p>
<p>In this PURE, we propose Scudo, a framework that combines the compromise
resilience and secure delivery protection of Uptane and the end-to-end software
supply chain security guarantees offered by in-toto. It describes how in-toto
metadata can be integrated into an automotive software supply chain that already
uses Uptane. It further establishes verification responsibilities for ECUs based
on the resources they possess and presents a stop-gap option for automobiles
with no sufficiently capable ECUs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="motivation">Motivation<a href="#motivation" class="hash-link" aria-label="Direct link to Motivation" title="Direct link to Motivation">​</a></h2>
<p>Software supply chain attacks are on the rise with the
<a href="https://www.sonatype.com/state-of-the-software-supply-chain/introduction" target="_blank" rel="noopener noreferrer">2022 State of the Software Supply Chain report</a>,
noting a 742% increase over the course of the last three years. But, it was the
<a href="https://www.cynet.com/attack-techniques-hands-on/sunburst-backdoor-c2-communication-protocol/" target="_blank" rel="noopener noreferrer">2020 Sunburst attack</a>
that really made both government and corporate CISOs take action. Affecting more
than 100 companies and nine government agencies, the cause of the attack was
Sunburst malware that had been uploaded via a routine update from Orion software
produced by SolarWinds. The attack taught both public and private concerns some
hard lessons, such as:</p>
<ul>
<li>The very thing designed to protect the security of software-patches and
updates that fix routine vulnerabilities-can also be used to deliver malware
that can damage or corrupt.</li>
<li>As software products contain third-party components, program developers are
not in complete control of the contents of their products.</li>
<li>Malware can linger undetected for extended periods of time, allowing it to
infect every system that touches it. The Sunburst malicious code was part of
an update released by SolarWinds in the spring of 2020, yet it was not
reported until December of that year.</li>
</ul>
<p>Automotive software supply chains are particularly tempting targets for
attackers. This is because automotive software runs on a large number of
vehicles and updating all of them to recover quickly from an attack is a
slow and difficult proposition. As such, a successful software supply chain
attack means that thousands (or more) of vehicles are impacted. Any attack that
targets a large number of vehicles on roads can do immeasurable damage. Further,
while Uptane can securely deliver updates to vehicles to recover from the
attack, ensuring every vehicle on the road receives the update immediately is
very difficult given the circumstances of use of these vehicles. Therefore,
strategies that can secure automotive software supply chains are vital to
<em>avoid</em> such attacks altogether.</p>
<p>Governments around the world have recognized this fact. Regulations are
forthcoming from the United Nations and other governing bodies, and standards
have been published that specify how software running on automobiles must be
secured. President Biden of the United States of America issued an Executive
Order describing the need to improve the nation&#x27;s cybersecurity. This EO, in
particular, pushes for solutions like Software Bills of Materials (SBOMs) that
list the components of software artifacts. This information is vital in ensuring
developers are aware of the components in their supply chain so that they can
fix vulnerabilities as and when they are discovered. For example, an SBOM would
help developers react quickly to situations like 2021&#x27;s log4j incident by
informing them of the software products that require patches or updates.</p>
<p>Unfortunately, SBOMs do not provide end-to-end software supply chain security.
They do not guarantee the integrity of either the operations performed as part
of the software supply chain, or the artifacts they consume and produce. An SBOM
also cannot help with verifying that each operation was performed by authorized
actors, or indeed that all required operations were in fact performed. So, the
use of SBOMs will not prevent attacks like that against SolarWinds, which used a
compromised build server. A more comprehensive framework is necessary and is
described in this document.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reasoning">Reasoning<a href="#reasoning" class="hash-link" aria-label="Direct link to Reasoning" title="Direct link to Reasoning">​</a></h2>
<p>in-toto is a comprehensive framework that secures each step in the software
supply chain. With in-toto, software supply chain owners can enforce policies
pertaining to the flow of artifacts through the supply chain, and provide proof
that authorized people or bots made changes to artifacts at any given step.
Thus, in-toto can be used to secure software from the very first step all the
way through the development pipeline. Furthermore, the framework plays well with
other systems and tools that attempt to secure specific aspects of the software
supply chain. in-toto is integrated into build tools and systems like Jenkins
and Tekton, and is compatible with complementary software supply chain security
efforts such as SLSA, Grafeas, Sigstore, and SBOMs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="specification">Specification<a href="#specification" class="hash-link" aria-label="Direct link to Specification" title="Direct link to Specification">​</a></h2>
<p>Note: The reader is expected to be familiar with the
<a href="https://github.com/in-toto/docs/blob/master/in-toto-spec.md" target="_blank" rel="noopener noreferrer">in-toto Specification</a>.</p>
<p>We describe how in-toto can be used to achieve software supply chain security
alongside the Uptane deployment. In such a model, in-toto can be backed by
the Uptane root of trust, and use Uptane&#x27;s delegation structure to distribute
all of in-toto&#x27;s metadata. Essentially, in-toto metadata is used to attest to
the steps performed in the software supply chain itself, while Uptane is used
to securely distribute that metadata alongside the ECU images. This combination
of in-toto for software supply chain guarantees and Uptane for secure
distribution of ECU images and in-toto metadata is called Scudo.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modifications-to-the-repositories-and-vehicle-interactions">Modifications to the Repositories and Vehicle Interactions<a href="#modifications-to-the-repositories-and-vehicle-interactions" class="hash-link" aria-label="Direct link to Modifications to the Repositories and Vehicle Interactions" title="Direct link to Modifications to the Repositories and Vehicle Interactions">​</a></h3>
<p>To implement Scudo, Uptane&#x27;s Image repository will need to be updated to enable
it to store in-toto metadata alongside the images. While the Director repository
can also be used, the Image repository is recommended as its contents are
typically signed for using offline keys.</p>
<p>When an image is submitted to the Image repository, it MUST be accompanied by
its in-toto metadata. The in-toto layout and link metadata for every image are
noted in the opaque &quot;custom&quot; field of the image&#x27;s entry in Targets metadata.
This way, there is no ambiguity about the in-toto metadata to be used when an
image is fetched and verified. Further, as it MAY not be practical for the top
level Targets role to issue new metadata for every update, Uptane&#x27;s delegations
model can be used to make this entire process more scalable. Instead, delegated
roles can be used to sign for the image itself and its in-toto link metadata.
However, in-toto layouts and the key artifacts used to verify them SHOULD be
signed for by roles that use <em>offline</em> keys. An example of such a role
in typical deployments is the top level Targets role.</p>
<p>As the Image repository handles in-toto metadata for the images, the Director
repository has no additional responsibilities than those specified in the Uptane
standard. Once the Director repository decides which images are required and
signs Targets metadata for them, the vehicle MUST fetch the images and all the
corresponding metadata using the interfaces provided by both the repositories.
From the Director repository, the automobile receives Uptane metadata only. From
the Image repository, the automobile receives Uptane metadata, the image itself,
and its corresponding in-toto metadata.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-verification-ecus">Full Verification ECUs<a href="#full-verification-ecus" class="hash-link" aria-label="Direct link to Full Verification ECUs" title="Direct link to Full Verification ECUs">​</a></h3>
<p>The Primary ECU receives images and metadata from the repositories, and sends
them on to the other ECUs that it updates. Each Full Verification ECU is
extended to perform independent in-toto verification that will be secure even
if the Primary ECU is compromised. Some Full Verification ECUs, for example the
Primary, are also expected to perform in-toto verification on behalf of Partial
Verification ECUs that are resource constrained.</p>
<p>For every target image the client needs to install, the corresponding in-toto
layout, links, and keys are identified via the custom field of the existing
Uptane metadata. These files are available as targets on the Image repository.
Therefore, for each installable target, the updater will need to download and
verify the Uptane metadata that signs for the in-toto metadata, either the
Targets role or a delegated role. If verification passes, the actual in-toto
metadata files—layout, links, and public keys—MUST be downloaded and their
hashes MUST be compared with the Uptane metadata. With these two checks,
Uptane’s secure delivery properties are extended to the in-toto files. These
files can then be used with confidence by the client to perform in-toto
verification.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="resource-constrained-ecus">Resource Constrained ECUs<a href="#resource-constrained-ecus" class="hash-link" aria-label="Direct link to Resource Constrained ECUs" title="Direct link to Resource Constrained ECUs">​</a></h3>
<p>There are a number of different types of resource constraints that accompany the
addition of in-toto metadata. Some automobiles MAY have no ECUs capable of
providing even a basic level of software supply chain security due to bandwidth
or memory constraints. Therefore, this PURE presents a &quot;stop-gap&quot; option. In
this configuration, the repository verifies the software supply chain of the
image and signs an in-toto <em>summary link</em> with the keys used to sign either the
top level Targets or delegated signer role. This way, the key used to sign the
summary link metadata is securely bootstrapped and can be rotated in case of a
compromise.</p>
<p>For each target image, the <em>custom</em> field points to the summary link rather than
all the in-toto metadata. The client MUST download and verify the Targets
metadata for the summary link and, if this passes, download and verify the hash
and signature on the summary link. Once the authenticity of the summary link is
established, the client MUST verify that the hashes in the products field of the
summary link match those of the image.</p>
<p>The summary link does offer some evidence that the repository performed in-toto
verification on behalf of the automobile, but it is <strong>not</strong> a sufficiently
strong replacement for actual verification on the vehicle. A key issue with the
stop-gap option is that it turns the Image repository into a single point of
failure and therefore can only be trusted as long as the repository remains
secure. As such, this model MUST only be adopted as a stop-gap option until the
update system can be transitioned to the full model in which in-toto
verification happens on individual vehicles.</p>
<p>Another resource that MAY be constrained is the amount of in-vehicle bandwidth
available to transfer data between the different ECUs. The addition of in-toto
metadata greatly increases the amount of information communicated between the
Primary ECU and the other ECUs. In such vehicles, the Primary ECU MUST receive
the pertinent in-toto metadata in addition to the ECU image, perform in-toto
verification, and then forward the image and (optionally) the relevant Uptane
metadata. If the vehicle is configured such that the Uptane metadata is
forwarded to the target ECU, then the ECU can perform just the Uptane
verification workflow, either the full or partial variant depending on the
resources it possesses. However, as the Primary ECU MUST use the Uptane metadata
to verify the in-toto metadata it received for the image, it might be sufficient
to have it perform both Uptane and in-toto verification on behalf of the target
ECU. All non-primary ECUs can then perform just the partial verification
workflow. This is an implementation detail left to adopters to decide.</p>
<table><thead><tr><th>Type of ECU</th><th>Uptane Responsibility</th><th>in-toto Responsibility</th></tr></thead><tbody><tr><td>Primary ECU</td><td>Full Uptane verification for its images, for all in-toto metadata, and (optionally) other ECU images</td><td>All in-toto verification</td></tr><tr><td>Secondary Full Verification ECU</td><td>(Optional) Full / partial Uptane verification for its images</td><td>No in-toto verification</td></tr><tr><td>Resource Constrained ECU</td><td>(Optional) Partial Uptane verification for its images</td><td>No in-toto verification</td></tr></tbody></table>
<p><strong>Table:</strong> Comparison of responsibilities expected of different ECUs deployed
with limited in-vehicle bandwidth. The in-toto verification process used can be
either the full workflow or the stop-gap option, as this choice does not affect
individual ECUs, but only the setup as a whole.</p>
<p>Finally, even if the additional in-vehicle bandwidth overhead is not a concern,
a subset of ECUs MAY lack the resources to perform all of Scudo&#x27;s verification
workflows. Note that in the stop-gap option, <em>all</em> ECUs lacked the necessary
resources. Uptane already accounts for such secondary ECUs by providing a
separate Partial Verification workflow. Scudo assumes that these Partial
Verification ECUs are also incapable of performing in-toto verification.
In addition, there MAY be Uptane Full Verification ECUs that also lack the
resources to perform the added in-toto verification.</p>
<p>For these ECUs, Scudo specifies that other capable ECUs, perhaps the Primary
ECU, MUST perform in-toto verification on behalf of the resource constrained
ECUs. In this model, while every ECU MAY NOT be verifying the software supply
chain of the images it is expected to install, verification is still happening
on the individual automobile. Essentially, there is no difference in the update
workflow of resource constrained ECUs but they are more robust because of by the
supply chain verification happening on the automobile.</p>
<table><thead><tr><th>Type of ECU</th><th>Uptane Responsibility</th><th>in-toto Responsibility</th></tr></thead><tbody><tr><td>Primary ECU (Full Verification)</td><td>Full Uptane verification for its images and all secondaries</td><td>in-toto verification of its images as well as images of resource constrained ECUs</td></tr><tr><td>Secondary Full Verification ECU</td><td>Full Uptane verification for its images</td><td>in-toto verification for its images</td></tr><tr><td>Resource Constrained ECU</td><td>Partial Uptane verification for its images</td><td>No in-toto verification</td></tr></tbody></table>
<p><strong>Table:</strong> Comparison of responsibilities expected of different ECUs where
in-vehicle communication bandwidth is not constrained. As before, the in-toto
verification process used can be either the full workflow or the stop-gap
option, as this choice does not affect individual ECUs, but only the setup as a
whole.</p>
<p>Note that the stop-gap option can be employed in conjunction with the solutions
for the other constraints. A vehicle MAY simultaneously have no ECUs capable of
full in-toto verification <em>and</em> limited bandwidth for in-vehicle communication.
Similarly, a vehicle MAY have no ECUs capable of full in-toto verification <em>and</em>
some of these ECUs MAY be incapable of any in-toto verification at all.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-analysis">Security Analysis<a href="#security-analysis" class="hash-link" aria-label="Direct link to Security Analysis" title="Direct link to Security Analysis">​</a></h2>
<p>Scudo is an extension for Uptane that adds in-toto&#x27;s software supply chain
security properties. Therefore, its threat model is a combination of the threat
models of Uptane for the delivery of the software artifacts, and in-toto for the
development of the image as it passes through the software supply chain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prototype">Prototype<a href="#prototype" class="hash-link" aria-label="Direct link to Prototype" title="Direct link to Prototype">​</a></h2>
<p>in-toto has previously been deployed with Uptane&#x27;s parent project, The Update
Framework (TUF), as described here in Datadog&#x27;s pipelines. This deployment has
been documented as two in-toto Enhancements (ITEs), [ITE-2] and [ITE-3]. Datadog
has also published a
<a href="https://www.datadoghq.com/blog/engineering/secure-publication-of-datadog-agent-integrations-with-tuf-and-in-toto/" target="_blank" rel="noopener noreferrer">blog post</a>
describing their setup and released
<a href="https://github.com/DataDog/integrations-core/tree/master/datadog_checks_downloader" target="_blank" rel="noopener noreferrer">open source tooling</a>
that combines in-toto&#x27;s and TUF&#x27;s verification workflows.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="backwards-compatibility">Backwards Compatibility<a href="#backwards-compatibility" class="hash-link" aria-label="Direct link to Backwards Compatibility" title="Direct link to Backwards Compatibility">​</a></h2>
<p>Backwards compatibility is a key factor when introducing in-toto to an existing
Uptane deployment. Merely adding in-toto metadata to Uptane Targets metadata
does not change Uptane&#x27;s verification workflow. Older Uptane clients can
continue to performing just Uptane&#x27;s verification workflow for the images and
safely ignore references to in-toto metadata.</p>
<p>In addition, adopters MUST be careful with how they switch their devices over
from performing only Uptane verification to also including in-toto verification
for their ECU images. This is because there MAY be older images without in-toto
metadata that are still the latest for their respective ECUs. In these cases,
the workflow MUST NOT expect in-toto metadata. Similarly, the workflow MUST NOT
be fooled into skipping in-toto verification for newer images that actually have
in-toto metadata.</p>
<p>Finally, as always, in-toto and Uptane implementations SHOULD NOT make
backward-incompatible changes to how signatures are generated. This will ensure
that previous package managers are able to continue to install new packages.
Note that Uptane can otherwise be used to safely rotate the keys for the entire
system, including those using different key types, key sizes, signature schemes,
and cryptographic hashes. Any backwards incompatible changes that are
unavoidable SHOULD be handled with a clear plan.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="copyright">Copyright<a href="#copyright" class="hash-link" aria-label="Direct link to Copyright" title="Direct link to Copyright">​</a></h2>
<p>This document has been placed in the public domain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgements">Acknowledgements<a href="#acknowledgements" class="hash-link" aria-label="Direct link to Acknowledgements" title="Direct link to Acknowledgements">​</a></h2>
<p>This PURE was inspired by two in-toto Enhancements, ITE-2 and ITE-3, that
describe how TUF, Uptane&#x27;s parent project, and in-toto can be combined.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://github.com/in-toto/docs/blob/master/in-toto-spec.md" target="_blank" rel="noopener noreferrer">in-toto Specification</a></li>
<li><a href="https://uptane.github.io/papers/uptane-standard.2.0.0.html" target="_blank" rel="noopener noreferrer">Uptane v2.0.0 Standard</a></li>
<li><a href="https://uptane.github.io/papers/scudo-whitepaper.pdf" target="_blank" rel="noopener noreferrer">Scudo Whitepaper</a></li>
<li><a href="https://github.com/in-toto/ITE/blob/master/ITE/2/README.adoc" target="_blank" rel="noopener noreferrer">ITE-2</a></li>
<li><a href="https://github.com/in-toto/ITE/blob/master/ITE/3/README.adoc" target="_blank" rel="noopener noreferrer">ITE-3</a></li>
<li><a href="https://www.sonatype.com/state-of-the-software-supply-chain/introduction" target="_blank" rel="noopener noreferrer">Sonatype&#x27;s 2022 State of the Software Supply Chain report</a></li>
<li><a href="https://www.cynet.com/attack-techniques-hands-on/sunburst-backdoor-c2-communication-protocol/" target="_blank" rel="noopener noreferrer">2020 Sunburst attack</a></li>
<li><a href="https://www.datadoghq.com/blog/engineering/secure-publication-of-datadog-agent-integrations-with-tuf-and-in-toto/" target="_blank" rel="noopener noreferrer">Secure Publication of Datadog Agent Integrations with TUF and in-toto</a></li>
<li><a href="https://github.com/DataDog/integrations-core/tree/master/datadog_checks_downloader" target="_blank" rel="noopener noreferrer">Datadog&#x27;s Verification of TUF and in-toto metadata</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/enhancements/pures/pure2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Offline Updates</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#motivation" class="table-of-contents__link toc-highlight">Motivation</a></li><li><a href="#reasoning" class="table-of-contents__link toc-highlight">Reasoning</a></li><li><a href="#specification" class="table-of-contents__link toc-highlight">Specification</a><ul><li><a href="#modifications-to-the-repositories-and-vehicle-interactions" class="table-of-contents__link toc-highlight">Modifications to the Repositories and Vehicle Interactions</a></li><li><a href="#full-verification-ecus" class="table-of-contents__link toc-highlight">Full Verification ECUs</a></li><li><a href="#resource-constrained-ecus" class="table-of-contents__link toc-highlight">Resource Constrained ECUs</a></li></ul></li><li><a href="#security-analysis" class="table-of-contents__link toc-highlight">Security Analysis</a></li><li><a href="#prototype" class="table-of-contents__link toc-highlight">Prototype</a></li><li><a href="#backwards-compatibility" class="table-of-contents__link toc-highlight">Backwards Compatibility</a></li><li><a href="#copyright" class="table-of-contents__link toc-highlight">Copyright</a></li><li><a href="#acknowledgements" class="table-of-contents__link toc-highlight">Acknowledgements</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer Container_nGT3"><div class="InnerContainer_Kdbd"><div class="ContentContainer_uzrc"><div class="FooterLeft_Fb_0"><div><img src="/img/uptane_logo_light.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" width="200" title="Securing Software Updates for Automobiles"><img src="/img/uptane_logo_dark.svg" alt="Uptane Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="200" title="Securing Software Updates for Automobiles"></div><div class="Tagline_JAGW">Securing Software Updates for Automobiles</div></div><div class="FooterRight_mGnE"><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">Docs</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/getting-started" label="Getting Started" to="/learn-more/getting-started">Getting Started</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/participate" label="Contributor&#x27;s Guide" to="/learn-more/participate">Contributor&#x27;s Guide</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/learn-more/about" label="About Us" to="/learn-more/about">About Us</a></ul></div><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">Community</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://discord.com/invite/uWyT6gDCqx" rel="noopener noreferrer" target="_blank" label="Discord">Discord</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://linkedin.com/company/uptane" rel="noopener noreferrer" target="_blank" label="LinkedIn">LinkedIn</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://www.youtube.com/@Uptane" rel="noopener noreferrer" target="_blank" label="Youtube">Youtube</a></ul></div><div class="SectionContainer_zhao"><li class="LinkItemTitle_ggQL">More</li><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="https://github.com/uptane" rel="noopener noreferrer" target="_blank" label="GitHub">GitHub</a></ul><ul class="LinkItemContainer_uDWT"><a class="LinkText_P6qP" href="/blog" label="Blog" to="/blog">Blog</a></ul></div></div></div><div class="BottomContainer_FVSV"><div class="CopyrightText_I8hq">© 2025 Uptane | All Rights Reserved</div></div></div></footer></div>
</body>
</html>